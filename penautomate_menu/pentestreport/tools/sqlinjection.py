import subprocess

def run_sqlmap(url):
    command = ['sqlmap', '-u', url, '--batch', '--forms']
    try:
        result = subprocess.run(command, capture_output=True, text=True, timeout=300)
        print("STDOUT:", result.stdout)
        print("STDERR:", result.stderr)
    except subprocess.TimeoutExpired:
        print("SQLmap did not finish within the timeout period.")

if __name__ == '__main__':
    test_url = "http://192.168.1.161/payroll_app.php"
    run_sqlmap(test_url)
