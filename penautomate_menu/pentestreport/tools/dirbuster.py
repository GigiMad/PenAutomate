import requests
from concurrent.futures import ThreadPoolExecutor
import os

def check_directory(url, word):
    target_url = url + "/" + word
    response = requests.get(target_url)
    if response.status_code == 200:
        print(f"[+] Directory found: {target_url}")

def dirbuster(url, wordlist_file, max_workers=20):
    with open(wordlist_file, 'r') as f:
        wordlist = f.read().splitlines()

    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        executor.map(lambda word: check_directory(url, word), wordlist)

# URL Ã  tester
url = "http://192.168.1.58"

# Chemin vers le fichier contenant la liste des mots
wordlist_file = os.path.join("penautomate_menu", "pentestreport", "tools", "directory-list-1.0.txt")

# Appel de la fonction dirbuster
dirbuster(url, wordlist_file)
